/****** Object:  StoredProcedure [dbo].[BO001]    Script Date: 4/24/2023 3:15:25 PM ******/
DROP PROCEDURE [dbo].[BO001]
GO

/****** Object:  StoredProcedure [dbo].[BO001]    Script Date: 4/24/2023 3:15:25 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO


CREATE PROCEDURE [dbo].[BO001]
(@METHOD VARCHAR(1) = '', @LOGLEVEL INT = 1)
AS

/* VERSION 4.6.1 */

TRUNCATE TABLE BO_DM_ACTIVITY_LOG;

INSERT INTO BO_DM_ACTIVITY_LOG (  ACTIVITY_TIMESTAMP, SCRIPT_ID, ACTION, DESCRIPTION, DM_BATCH_NO)
VALUES (GETDATE(),'BO001','RESET SICS REP. TABLES','',NULL)

INSERT INTO BO_DM_ACTIVITY_LOG (  ACTIVITY_TIMESTAMP, SCRIPT_ID, ACTION, DESCRIPTION, DM_BATCH_NO)
VALUES (GETDATE(),'BO001','SCRIPT START','',NULL)

TRUNCATE TABLE BO_PREM_CURR ;

TRUNCATE TABLE BOAC_WK4B_FACT ;

TRUNCATE TABLE BOAC_WK4A_FACT ;

TRUNCATE TABLE BOAC_WK3_FACT ;

TRUNCATE TABLE BOAC_WK2_RISKAREA ;

TRUNCATE TABLE BOAC_WK2_PARTY ;

TRUNCATE TABLE BOAC_WK2_PAIRING ;

TRUNCATE TABLE BOAC_WK2_NOTE ;

TRUNCATE TABLE BOAC_WK2_FACT ;

TRUNCATE TABLE BOAC_WK2_CLASSIFIC ;

TRUNCATE TABLE BOAC_WK1_YEAR ;

TRUNCATE TABLE BOAC_WK1_TIME ;

TRUNCATE TABLE BOAC_WK1_RISKAREA ;

TRUNCATE TABLE BOAC_WK1_PARTY ;

TRUNCATE TABLE BOAC_WK1_PAIRING ;

TRUNCATE TABLE BOAC_WK1_NOTE ;

TRUNCATE TABLE BOAC_WK1_FACT ;

TRUNCATE TABLE BOAC_WK1_CLASSIFIC ;

TRUNCATE TABLE BOAC_WK1_BALANCE ;

TRUNCATE TABLE BOAC_TRN_RISKAREA ;

TRUNCATE TABLE BOAC_TRN_CLASSIFIC ;

TRUNCATE TABLE BOAC_TMP_PRNG_AMT ;

TRUNCATE TABLE BOAC_STL_PAIRING ;

TRUNCATE TABLE BOAC_STATUS ;

TRUNCATE TABLE BOAC_PC_FACT ;

TRUNCATE TABLE BOAC_LF_FACT ;

TRUNCATE TABLE BOAC_JT_ECG ;

TRUNCATE TABLE BOAC_DUP_WORKSHEET ;

TRUNCATE TABLE BOAC_DUP_DETAIL ;

TRUNCATE TABLE BOAC_DUP_BALANCE ;

TRUNCATE TABLE BOAC_DUPL_BALANCE ;

TRUNCATE TABLE BOAC_DIM_TIME ;

TRUNCATE TABLE BOAC_DIM_RISKAREA ;

TRUNCATE TABLE BOAC_DIM_PARTY ;

TRUNCATE TABLE BOAC_DIM_NOTE ;

TRUNCATE TABLE BOAC_DIM_ENTRY_CODE ;

TRUNCATE TABLE BOAC_DIM_CLASSIFIC ;

/* SUPPORT TABLES */

TRUNCATE TABLE BOAC_DETAIL_SUPPORT;

TRUNCATE TABLE BOAC_WK1_PC_MISSING;

TRUNCATE TABLE BOAC_PC_FACT_IGNORED;

/* INITIAL DETAIL 1BC */

INSERT INTO BOAC_STATUS
(COMPLETED_BATCH, CURRENT_BATCH)
VALUES (0, 0);

INSERT INTO BOAC_DIM_PARTY (DIM_KEY, OBJECT_ID_COMBINED)
VALUES (0, 'DUMMY');

INSERT INTO BOAC_DIM_CLASSIFIC
(DIM_KEY, FRK_COMBINED)
VALUES (0, 'NO CLASSIFICATION');

INSERT INTO BOAC_TRN_CLASSIFIC
(DIM_KEY, OBJECT_ID)
VALUES (0, 'NO CLASSIFICATION');

INSERT INTO BOAC_DIM_RISKAREA
(DIM_KEY, SUBCLASS, OBJECT_ID, IS_ACTIVE, NAME, CODE)
VALUES (0, 0, 'NO RISKAREA','N', 'NO RISKAREA', 'N/A');

INSERT INTO BOAC_TRN_RISKAREA
(DIM_KEY, FK_I_COUNTRY)
VALUES (0, 'NO RISKAREA');

INSERT INTO BOAC_DIM_NOTE (DIM_KEY, FK_BALANCE_NOTE, FK_DETAIL_NOTE, FK_COMBINED)
VALUES (0, 'NULL', 'NULL', 'NULLNULL');

UPDATE BOAC_STATUS SET CURRENT_BATCH = 1, COMPLETED_BATCH = 0
WHERE CURRENT_BATCH <> 1 OR COMPLETED_BATCH <> 0;

UPDATE AC_WORKSHEET
SET DM_BATCH_NUMBER = 0 , DM_TRANS_DATE = NULL
WHERE COALESCE(DM_BATCH_NUMBER,1) <> 0;

UPDATE AC_STL_PAIRING
SET DM_BATCH_NUMBER = 0, DM_TRANS_DATE = NULL
WHERE COALESCE(DM_BATCH_NUMBER,1) <> 0;

INSERT INTO BO_DM_ACTIVITY_LOG (  ACTIVITY_TIMESTAMP, SCRIPT_ID, ACTION, DESCRIPTION, DM_BATCH_NO)
VALUES (GETDATE(),'BO001','SCRIPT END','',NULL)

/* END SCRIPT */


GO

